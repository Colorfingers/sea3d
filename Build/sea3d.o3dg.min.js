SEA3D.GeometryGC=function(d,a,b){this.name=d;this.data=a;this.sea3d=b;var f=a.readUShort();d=[];var g,h;this.isBig=0!=(f&1);a.readVInt=this.isBig?a.readUInt:a.readUShort;if(f&2){this.groups=[];var c=a.readUByte(),e=0;for(b=0;b<c;b++){var k=3*a.readVInt();this.groups.push({start:e,count:k});e+=k}}else this.groups=[];if(f&4)for(this.uv=[],c=a.readUByte(),b=0;b<c;b++)d[b]=a.readUByte();f&32&&(g=a.readUByte(),h=a.readUByte());b=a.readUInt();b=a.concat(a.position,b);a=new o3dgc.BinaryStream(b.buffer);
f=new o3dgc.SC3DMCDecoder;c=new o3dgc.IndexedFaceSet;f.DecodeHeader(c,a);b=c.GetNCoordIndex();e=c.GetNCoord();this.groups.length||this.groups.push({start:0,count:3*b});this.indexes=this.isBig?new Uint32Array(3*b):new Uint16Array(3*b);this.vertex=new Float32Array(3*e);c.SetCoordIndex(this.indexes);c.SetCoord(this.vertex);0<c.GetNNormal()&&(this.normal=new Float32Array(3*e),c.SetNormal(this.normal));for(b=0;b<d.length;b++)this.uv[b]=new Float32Array(2*e),c.SetFloatAttribute(d[b],this.uv[b]);void 0!==
g&&(this.jointPerVertex=c.GetIntAttributeDim(g),this.joint=new Uint16Array(e*this.jointPerVertex),this.weight=new Float32Array(e*this.jointPerVertex),c.SetIntAttribute(g,this.joint),c.SetFloatAttribute(h,this.weight));f.DecodePlayload(c,a)};SEA3D.GeometryGC.prototype.type="s3D";SEA3D.GeometryUpdateGC=function(d,a,b){this.name=d;this.data=a;this.sea3d=b;this.index=a.readUInt();this.bytes=a.concat(a.position,a.length-a.position)};SEA3D.GeometryUpdateGC.prototype.type="us3D";
THREE.SEA3D.prototype.readGeometryUpdateGC=function(d){var a=this.file.objects[d.index].tag;d=new SEA3D.GeometryGC("",d.bytes,d.sea3d);d.tag=a;this.readGeometryBuffer(d)};THREE.SEA3D.EXTENSIONS_LOADER.push({setTypeRead:function(){this.file.addClass(SEA3D.GeometryGC,!0);this.file.addClass(SEA3D.GeometryUpdateGC,!0);this.file.typeRead[SEA3D.GeometryGC.prototype.type]=this.readGeometryBuffer;this.file.typeRead[SEA3D.GeometryUpdateGC.prototype.type]=this.readGeometryUpdateGC}});
